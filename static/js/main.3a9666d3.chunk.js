(this["webpackJsonpreactive-portrait"]=this["webpackJsonpreactive-portrait"]||[]).push([[0],{12:function(t,e,i){},13:function(t,e,i){},14:function(t,e,i){"use strict";i.r(e);var n=i(0),a=i.n(n),o=i(6),r=i.n(o),s=(i(12),i(1)),h=i(2),p=i(4),c=i(3),u={idle:{minDurationS:0,transitions:{tick50Ms:{wave:{probability:.001},lookingAround:{probability:.001},lookingAround2:{probability:.001}},attention:{wave:{probability:.2},thumbsUp:{probability:.3},knockKnock:{probability:.3},thinking:{probability:.2}},mouseUp:{lookingUp:{probability:.05}},mouseUpLeft:{lookingUpLeft:{probability:.05}},mouseUpRight:{lookingUpRight:{probability:.05}},mouseLeft:{lookingLeft:{probability:.05}},mouseRight:{lookingRight:{probability:.05}},mouseDown:{lookingDown:{probability:.05}},mouseDownLeft:{lookingDownLeft:{probability:.05}},mouseDownRight:{lookingDownRight:{probability:.05}}}},wave:{minDurationS:3,transitions:{tick50Ms:{idle:{}}}},thumbsUp:{minDurationS:4.6,transitions:{tick50Ms:{idle:{}}}},knockKnock:{minDurationS:6.9,transitions:{tick50Ms:{idle:{}}}},thinking:{minDurationS:6.9,transitions:{tick50Ms:{idle:{}}}},lookingAround:{minDurationS:7,transitions:{tick50Ms:{idle:{}}}},lookingAround2:{minDurationS:6.3,transitions:{tick50Ms:{idle:{}}}},lookingUp:{minDurationS:5.6,transitions:{tick50Ms:{idle:{}}}},lookingUpLeft:{minDurationS:5.5,transitions:{tick50Ms:{idle:{}}}},lookingUpRight:{minDurationS:7,transitions:{tick50Ms:{idle:{}}}},lookingLeft:{minDurationS:6,transitions:{tick50Ms:{idle:{}}}},lookingRight:{minDurationS:5.5,transitions:{tick50Ms:{idle:{}}}},lookingDown:{minDurationS:5.3,transitions:{tick50Ms:{idle:{}}}},lookingDownLeft:{minDurationS:7.3,transitions:{tick50Ms:{idle:{}}}},lookingDownRight:{minDurationS:7.3,transitions:{tick50Ms:{idle:{}}}}},l=function(){function t(e){Object(s.a)(this,t),this._state=e,this._stateStartTime=(new Date).getTime()}return Object(h.a)(t,[{key:"getState",value:function(){return this._state}},{key:"getNewState",value:function(t){return this._updateState(t),this._state}},{key:"_updateState",value:function(t){var e=u[this._state];if(!((new Date).getTime()-this._stateStartTime<1e3*e.minDurationS)){var i=e.transitions[t];if(i)for(var n=Math.random(),a=0,o=0,r=Object.entries(i);o<r.length;o++){var s=r[o];if(!((a+=s[1].probability||1)<n))return this._stateStartTime=(new Date).getTime(),void(this._state=s[0])}}}}]),t}(),d=[10,23.26],m=function(t){Object(p.a)(i,t);var e=Object(c.a)(i);function i(t){var n;return Object(s.a)(this,i),(n=e.call(this,t)).onVideoLoaded=function(t){n.videoRef.current.currentTime=n.getVideoStartTime(),n.props.onVideoLoaded&&n.props.onVideoLoaded(t)},n.videoRef=a.a.createRef(),n}return Object(h.a)(i,[{key:"isVideoReady",value:function(){return this.videoRef.current&&4===this.videoRef.current.readyState}},{key:"playFromBeginning",value:function(){if(this.isVideoReady()){var t=0;"idle"===this.props.name&&(t=d[Math.floor(Math.random()*d.length)]),this.videoRef.current.currentTime=t}}},{key:"getVideoStartTime",value:function(){return"idle"===this.props.name?d[Math.floor(Math.random()*d.length)]:0}},{key:"render",value:function(){return a.a.createElement("div",{style:{position:"absolute",top:0,left:0,width:this.props.width,height:this.props.height,borderRadius:this.props.width/2,WebkitMaskImage:"-webkit-radial-gradient(circle, white 100%, black 100%)"}},a.a.createElement("video",{ref:this.videoRef,autoPlay:!0,muted:!0,loop:!0,onLoadedData:this.onVideoLoaded,width:this.props.width,height:this.props.height,style:{opacity:this.props.opacity}},a.a.createElement("source",{src:this.props.mediaPath+"/"+this.props.name+".mov"})))}}]),i}(a.a.Component),f=function(t){Object(p.a)(i,t);var e=Object(c.a)(i);function i(t){var n;return Object(s.a)(this,i),(n=e.call(this,t)).updateTransition=function(){if(!(n.state.transitionFraction>=1)&&n.nextSnippetRef.current&&n.nextSnippetRef.current.isVideoReady()){n.transitionStartTime||(n.transitionStartTime=(new Date).getTime(),n.nextSnippetRef.current.playFromBeginning());var t=(new Date).getTime()-n.transitionStartTime,e=Math.min(t/400,1);n.setState({transitionFraction:e})}},n.transitionStartTime=null,n.state={transitionFraction:1},n.nextSnippetRef=a.a.createRef(),n}return Object(h.a)(i,[{key:"shouldComponentUpdate",value:function(t,e){return t.newName===this.props.newName||(e.transitionFraction=0,this.transitionStartTime=null),!0}},{key:"componentDidMount",value:function(){this._timer=window.setInterval(this.updateTransition,30)}},{key:"componentWillUnmount",value:function(){window.clearInterval(this._timer)}},{key:"render",value:function(){return a.a.createElement("div",null,a.a.createElement(m,{key:this.props.name,mediaPath:this.props.mediaPath,width:this.props.width,height:this.props.height,name:this.props.name,opacity:1}),this.props.newName&&this.props.newName!==this.props.name?a.a.createElement(m,{ref:this.nextSnippetRef,key:this.props.newName,mediaPath:this.props.mediaPath,opacity:this.state.transitionFraction,width:this.props.width,height:this.props.height,name:this.props.newName}):null)}}]),i}(a.a.Component),g=function(t){Object(p.a)(i,t);var e=Object(c.a)(i);function i(t){var n;return Object(s.a)(this,i),(n=e.call(this,t)).tick50Ms=function(){n.updateStateMachine("tick50Ms")},n.onMouseMove=function(t){if(n.rootRef.current){var e,i,a,o=n.rootRef.current.getBoundingClientRect(),r=o.x+Math.round(o.width/2),s=o.y+Math.round(o.height/2),h=t.clientX-r,p=t.clientY-s;if(!(Math.sqrt(Math.pow(h,2)+Math.pow(p,2))<.75*o.width))h>0?(e=Math.atan(-1*p/h)*(180/Math.PI),i="Right"):(e=Math.atan(p/h)*(180/Math.PI),i="Left"),a=e>67.5?"Up":e>22.5?"Up"+i:e>-22.5?i:e>-67.5?"Down"+i:"Down",n.updateStateMachine("mouse"+a)}},n.onAttention=function(){n.updateStateMachine("attention")},n.stateMachine=new l(i.defaultSnippet),n.rootRef=a.a.createRef(),n.state={stateMachine:n.stateMachine,snippetName:n.stateMachine.getState(),newSnippetName:n.stateMachine.getState()},n}return Object(h.a)(i,[{key:"componentDidMount",value:function(){this._timer=window.setInterval(this.tick50Ms,100),window.addEventListener("mousemove",this.onMouseMove)}},{key:"componentWillUnmount",value:function(){window.clearInterval(this._timer)}},{key:"updateStateMachine",value:function(t){var e=this.stateMachine.getNewState(t);e!==this.state.newSnippetName&&(this.props.onSnippetChanged&&this.props.onSnippetChanged(e),this.setState({snippetName:this.state.newSnippetName,newSnippetName:e}))}},{key:"render",value:function(){return a.a.createElement("div",{ref:this.rootRef,onMouseEnter:this.onAttention,onClick:this.onAttention,style:{position:"relative",width:this.props.width,height:this.props.height}},a.a.createElement(f,{mediaPath:this.props.snippetsMediaPath,width:this.props.width,height:this.props.height,name:this.state.snippetName,newName:this.state.newSnippetName}))}}]),i}(a.a.Component);g.defaultSnippet="idle";i(13);var k=function(t){Object(p.a)(i,t);var e=Object(c.a)(i);function i(t){var n;return Object(s.a)(this,i),(n=e.call(this,t)).onPortraitChanged=function(t){n.setState({snippetName:t})},n.state={snippetName:g.defaultSnippet},n}return Object(h.a)(i,[{key:"render",value:function(){return a.a.createElement("div",{className:"App"},a.a.createElement("header",{className:"App-header"},a.a.createElement(g,{snippetsMediaPath:"media",onSnippetChanged:this.onPortraitChanged,width:400,height:400}),a.a.createElement("div",{style:{paddingTop:"20px"}},this.state.snippetName)))}}]),i}(a.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(a.a.createElement(a.a.StrictMode,null,a.a.createElement(k,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()})).catch((function(t){console.error(t.message)}))},7:function(t,e,i){t.exports=i(14)}},[[7,1,2]]]);
//# sourceMappingURL=main.3a9666d3.chunk.js.map